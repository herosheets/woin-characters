angular = require('angular');

angular.module('woin-character')
  .service('ExploitService', ['$rootScope', function($rootScope) {

    var meetsCareerRequirements = function(character, exploit, exploitData) {
      console.log("entered meetsCareerRequirements: " + exploit);
      var exploitRequirements = exploitData[exploit].career_exploit_prereq.split(',');
      console.log("Looking for exploit: " + exploit);
      console.log("Requirements are: ");
      console.log(exploitRequirements);
      var meetsRequirements = true;
      if (exploitRequirements !== undefined) {
        angular.forEach(exploitRequirements, function(requirement) {
          if (requirement !== undefined && requirement !== '') {
            meetsRequirements = meetsRequirements &&  _.find(character.exploits, { Exploit: requirement })
          }
        });
      }
      console.log("Character meets requirement? " + meetsRequirements);
      return meetsRequirements;
    };

    var meetsPrerequisites = function(character, exploit) {
      console.log("entered meetsCareerRequirements: " + exploit);
      console.log("for character: " + character);
      return true;
    };

    return {
      meetsCareerRequirements: meetsCareerRequirements,
      meetsPrerequisites: meetsPrerequisites
    };
  }])